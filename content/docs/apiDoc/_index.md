---
weight: 1
bookFlatSection: true
title: "Next-stage"
---


 


# 预警指标接口文档 v1.1

## 1 规范说明

### 1.1 通信协议

HTTP协议

### 1.2 请求方法
具体接口具体要求

### 1.3 字符编码
HTTP通讯采用UTF-8字符集编码格式。

### 1.4 格式说明
元素出现要求说明：

符号				|说明
:----:			|:---
R				|报文中该元素必须出现（Required）
O				|报文中该元素可选出现（Optional）
C				|报文中该元素在一定条件下出现（Conditional）

### 1.5 报文规范说明

1. 报文规范仅针对交易请求数据进行描述；  

2. 报文规范中请求报文的内容为Http请求报文中RequestData值的明文内容；

3. 报文规范分为请求报文和响应报文。请求报文描述由发起方，响应报文由报文接收方响应。

### 1.6 请求报文结构

#### 1.6.1 参数说明
**RequestData（请求内容）：** 其明文为每次请求的具体参数，采用 JSON 格式.

#### 1.6.2 请求内容（RequestData）明文结构说明

采用JSON格式，其中包含Header（公有参数）、Body（私有参数）节点：

名称		|描述											|备注
:--		|:--											|:--
<!-- 公共参数	|每个接口都包含的通用参数，以JSON格式存放在Header属性	|详见以下公共参数说明 -->
私有参数	|每个接口特有的参数，以JSON格式存放在Body属性		|详见每个接口定义

<!-- **公共参数说明：**

公共参数（Header）是用于标识产品及接口鉴权的参数，每次请求均需要携带这些参数：

参数名称				|类型		|出现要求	|描述  
:----				|:---		|:------	|:---	
token				|string		|R			|用户登录后token，没有登录则为空字符串 -->

### 1.7 响应报文结构
#### 1.7.1 结构说明
所有接口响应均采用JSON格式，如无特殊说明，每次请求的返回值中，都包含下列字段：

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
<!-- code						|int		|R			|响应码，代码定义请见“附录A 响应吗说明” -->
result						|object		|R			|每个接口特有的参数，详见每个接口定义


## 2. 接口定义

### 2.1 获取检测状态异常率
- **接口说明：** 检测状态异常率
- **接口地址：** /external/device_abnormal
- **接口方法：** GET

#### 2.1.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.1.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;abnormalTotal				|[]string		|R			|异常设备号数组
<!-- &emsp;validTotal				|[]string		|R			|有效设备号数组 -->



示例：

```
{
    "results": {
        "abnormalTotal": [
            "32050200041320000658",
            "32050000001326000020",
            "32050000001326000021",
            "32050000001326000022"
        ]
    }
}
```


### 2.2 获取设备延迟率
- **接口说明：** 请求时间-抓拍时间>30s
- **接口地址：** /external/device_delay_rate
- **接口方法：** GET

#### 2.2.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.2.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;delayTotal				|[]string		|R			|延迟的设备号数组
<!-- &emsp;validTotal				|[]string		|R			|有效的设备号数组 -->



示例：

```
{
    "results": {
        "delayTotal": [
            "32050200041320000658",
            "32050000001326000020",
            "32050000001326000021",
            "32050000001326000022"
        ]
    }
}
```


### 2.3 获取设备倒挂率
- **接口说明：** 倒挂：请求时间<抓拍时间
- **接口地址：** /external/device_invert
- **接口方法：** GET

#### 2.3.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.3.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;invertTotal				|[]string		|R			|倒挂的设备号数组


示例：

```
{
    "results": {
        "invertTotal": [
            "32050200041320000658",
            "32050000001326000020",
            "32050000001326000021",
            "32050000001326000022"
        ]
    }
}
```


### 2.4 获取报文合格率
- **接口说明：** 合格设备数组：所有有效报文数等于所有报文数的设备编号
- **接口地址：** /external/message_qualified
- **接口方法：** GET

#### 2.4.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.4.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;qualifiedTotal				|map		|R			|抽检合格的设备map key为设备编号 value为报文数量
&emsp;checkTotal				|map		|R			|产生有效的报文的设备map  key为设备编号 value为报文数量



示例：

```
{
    "results": {
        "qualifiedTotal": {
            "32050651001320100630": 1,
            "32058200001310000401": 1,
            "32059423001310002240": 1
        },
        "checkTotal": {
            "32050651001320100630": 1,
            "32058200001310000401": 2,
            "32059423001310002240": 2
        }
    }
}
   

```

### 2.5 场景图URL异常率
- **接口说明：** 接收的场景图URL访问异常：code为5011014的图片的设备号数组      接收的场景图图片总数：code为5011014和2010014的图片的设备号数组
- **接口地址：** /external/scene_graph_url_abnormal
- **接口方法：** GET

#### 2.5.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.5.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;abnormalTotal				|map		|R			|接收的场景图URL访问异常图片的设备map key为设备编号 value为图片数量
&emsp;receiveTotal				|map		|R			|接收的场景图图片的设备map key为设备编号 value为图片数量



示例：

```
{
    "results": {
        "abnormalTotal": {
            "32058200001310000426": 1
        },
        "receiveTotal": {
            "32058200001310000426": 2,
            "32059423001310002241": 1
        }
    }
}
```




### 2.6 场景图不可用率
- **接口说明：** 接收的场景图URL访问异常：code为5010014的图片的设备号数组        接收的场景图图片总数：code为2010014和5010014的图片的设备号数组
- **接口地址：** /external/scene_graph_unavailable
- **接口方法：** GET

#### 2.6.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.6.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;abnormalTotal				|map		|R			|接收的场景图不可用的图片的设备map key为设备编号 value为图片数量
&emsp;receiveTotal				|map		|R			|接收的场景图的设备map key为设备编号 value为图片数量



示例：

```
{
    "results": {
        "abnormalTotal": {
            "32058254001310206429": 1
        },
        "receiveTotal": {
            "30250667001320101001": 8,
            "32058200001310000426": 3,
            "32058253001324076656": 4,
            "32058254001310206377": 2,
            "32058254001310206429": 4,
            "32058263051320900005": 2,
            "32058263051320900031": 2,
            "32058368001310149987": 4,
            "32059409001310013420": 1,
            "32059423001310002240": 12,
            "32059423001310002241": 2,
            "32059453011320022001": 6
        }
    }
}
```


### 2.7 人脸图不合格率
- **接口说明：** 根据设备号获取有效人脸图片数和人脸图片总数
- **接口地址：** /external/face_disqualification
- **接口方法：** GET

#### 2.7.1 请求参数

参数名称						|类型		|出现要求	|描述  
:----						   |:---		|:------	|:---
device_id                       |int		|O			|设备编号
page_num			         	|int		|O			|分页页码
page_size			         	|int		|O		    |分页大小
请求示例：
/external/face_disqualification?device_id=32058252001310208207
/external/face_disqualification?page_num=0&page_size=2
#### 2.7.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results					  	|object		|R			|&nbsp;
&emsp;validTotal				|int		|R			|接收的有效人脸图片数
&emsp;receiveTotal				|int		|R			|接收的人脸图片总数
&emsp;deviceId				    |string		|R			|设备编号
示例：

```
{
    "results": [
        {
            "validTotal": 9756,
            "receiveTotal": 12179,
            "deviceId": "32058366001310319301"
        },
        {
            "validTotal": 16751,
            "receiveTotal": 18545,
            "deviceId": "32059423001310002248"
        }
    ]
}
```


<!-- ### 2.8 抓拍量突降设备占比
- **接口说明：** 抓拍量突降设备占比 tips:抓拍突降：（昨天的抓拍量-前天的抓拍量）/昨天的抓拍量>0.2
- **接口地址：** /external/device_capture_undershoot
- **接口方法：** GET

#### 2.8.1 请求参数

参数名称						|类型		|出现要求	|描述  
GET接口，无参数


请求示例：
该接口为GET接口，且无参数，直接访问即可。


#### 2.8.2 返回结果

参数名称						|类型		|出现要求	|描述  
:----						|:---		|:------	|:---	
results						|object		|R			|&nbsp;
&emsp;undershootTotal				|[]string		|R			|抓拍突降的有效的设备号数组
&emsp;validTotal				|[]string		|R			|所有有效的设备号数组



示例：

```
{
    "results": {
        "undershootTotal": [
            "32050200041320000658",
            "32050000001326000020",
            "32050000001326000021"
        ]
        "validTotal": [
            "32050200041320000658",
            "32050000001326000020",
            "32050000001326000021",
            "32050000001326000022",
            "32050000001326000023",
            "32050000001326000072",
            "32050000001326000073",
            "32050000001326000038",
            "32050000001326000039",
            "32050800001326000025",
            "32058254001310206377",
            "32058254001310206429",
            "32058254001310206481",
            "32058254001310206583",
            "32058254001310206632",
            "32058252001310209063",
            "32058252001310209112",
            "32058252001310209164",
            "32058252001310209213",
            "32058252001310209265",
            "32058252001310209318",
            "32058252001310208155",
            "32058252001310208207",
            "32059352001320100092",
            "32059352001320100093"
        ]
    }
}
``` -->

## 3 附录A 响应码说明

响应码	|说明  
:----	|:---
200		|处理成功
400		|参数不正确
500		|系统内部错误





